<mvc:View
    controllerName="ns.artists.controller.Leaderboard"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:tnt="sap.tnt"
    xmlns:mc="sap.suite.ui.microchart">

    <Page title="Artist Leaderboard" showNavButton="true" navButtonPress=".onNavHome">
        <content>
            
            <!-- 1. GENRE FILTER TABS -->
            <IconTabBar 
                id="genreFilter" 
                select=".onFilterGenre"
                expandable="false"
                headerBackgroundDesign="Transparent"
                class="sapUiResponsiveContentPadding">
                <items>
                    <IconTabFilter key="All" text="Alles" icon="sap-icon://group" />
                    <IconTabSeparator />
                    <IconTabFilter key="Techno" text="Techno" icon="sap-icon://sound-loud" />
                    <IconTabFilter key="House" text="House" icon="sap-icon://sound" />
                    <IconTabFilter key="EDM" text="EDM" icon="sap-icon://electro" />
                    <IconTabFilter key="Trance" text="Trance" icon="sap-icon://radar" />
                </items>
            </IconTabBar>

            <!-- 2. DE TABEL -->
            <Table
                id="leaderboardTable"
                items="{
                    path: '/ArtistsLeaderboard', 
                    sorter: {
                        path: 'averageRating',
                        descending: true
                    }
                }"
                width="auto"
                class="sapUiResponsiveMargin"
                growing="true"
                growingThreshold="20">
                
                <headerToolbar>
                    <Toolbar>
                        <Title text="Ranking (Live uit Reviews)" level="H2"/>
                    </Toolbar>
                </headerToolbar>

                <columns>
                    <!-- Rank & Naam -->
                    <Column width="5rem"><Text text="Act" /></Column>
                    <Column><Text text="Naam" /></Column>

                    <!-- Genre (verdwijnt op mobiel) -->
                    <Column minScreenWidth="Tablet" demandPopin="true"><Text text="Genre" /></Column>

                    <!-- Trend Grafiek -->
                    <Column width="8rem" hAlign="Center" minScreenWidth="Tablet" demandPopin="true">
                        <Text text="Trend" />
                    </Column>

                    <!-- Score -->
                    <Column hAlign="Center"><Text text="Rating" /></Column>

                    <!-- Reviews -->
                    <Column hAlign="End"><Text text="Feedback" /></Column>
                </columns>

                <items>
                    <ColumnListItem type="Inactive">
                        <cells>
                            <Avatar src="{imageUrl}" displaySize="XS" />
                            
                            <VBox>
                                <Title text="{name}" class="sapUiTinyMarginBottom" />
                                
                                <!-- Top Rated Badge (via Formatter) -->
                                <tnt:InfoLabel 
                                    text="TOP RATED" 
                                    colorScheme="8" 
                                    visible="{
                                        path: 'averageRating',
                                        targetType: 'any',
                                        formatter: '.formatTopRatedVisible'
                                    }" />
                            </VBox>

                            <!-- Genre -->
                            <Text text="{genre}" />

                     
                            <mc:DeltaMicroChart 
                                size="XS" 
                                value1="{averageRating}" 
                                value2="{previousRating}" 
                                title1="{averageRating}" 
                                title2="{previousRating}" 
                                displayValue1="{averageRating}" 
                                deltaDisplayValue="{= ${averageRating} &gt; ${previousRating} ? 'Stijgend' : (${averageRating} &lt; ${previousRating} ? 'Dalend' : 'Stabiel') }" 
                                color="{= ${averageRating} &gt; ${previousRating} ? 'Good' : (${averageRating} &lt; ${previousRating} ? 'Error' : 'Neutral') }" />
                            <!-- Sterren -->
                            <VBox alignItems="Center">
                                <RatingIndicator 
                                    value="{averageRating}" 
                                    iconSize="16px" 
                                    maxValue="5" 
                                    editable="false" />
                                <Text text="{averageRating} / 5.0" class="sapUiTinyMarginTop" />
                            </VBox>

                            <!-- Aantal Reviews -->
                            <ObjectNumber 
                                number="{reviewCount}" 
                                state="Success" 
                                unit="reviews" />
                        </cells>
                    </ColumnListItem>
                </items>
            </Table>

        </content>
    </Page>
</mvc:View>